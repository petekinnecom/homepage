var Model = require('app/articles/model');
var $ = require('jquery');

function PageLoader(name){
  this.name = name;
  this.$article = $('[data-article-name="'+name+'"]');
  this.deferred = $.Deferred();
  this.promise = this.deferred.promise();
  this.state = 'pending';
}

PageLoader.prototype.isOnPage = function(){
  return (this.$article.length > 0);
};

PageLoader.prototype.getArticle = function(){
  if (this.state === 'pending'){
    var model = Model.create({
      body: this.$article.html(),
    });
    this.deferred.resolve(model);
  }

  return this.promise;
};

module.exports = PageLoader;
