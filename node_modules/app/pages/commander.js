var terminal = require('app/terminal/model');
var pagesData = require('app/pages/cache_machine/pages_data');

function Commander(router){
  var routeToPage = function(match) {
    var id = match[1];

    if (id === 'list') {
      pagesData.forEach(function(page){
        terminal.log(page.name, {data: {input: 'page ' + page.name}} );
      });
    }
    else {
      terminal.log('Loaded page ' + id);

      router.push({
        controller: 'pages',
        id: id
      });

      setTimeout(terminal.close.bind(terminal), 1000);
    }
  };

  terminal.registerCommand({
    matcher: /^page (.*)/,
    fn: routeToPage,
  });
}

module.exports = Commander;
