var Model = require('app/pages/model');
var $ = require('jquery');

function PageLoader(page){
  this.name = page.name;
  this.$page = $('[data-page-name="'+name+'"]');
  this.deferred = $.Deferred();
  this.promise = this.deferred.promise();
  this.state = 'pending';
}

PageLoader.prototype.isOnPage = function(){
  return (this.$page.length > 0);
};

PageLoader.prototype.getPage = function(){
  if (this.state === 'pending'){
    var model = Model.create({
      body: this.$page.html(),
    });
    this.deferred.resolve(model);
  }

  return this.promise;
};

module.exports = PageLoader;
