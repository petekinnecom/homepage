var downloaders = require('app/pages/cache_machine/registry');

//TODO: Should only enqueue a certain number at a time

var start = function(){
  download(0);
};

var download = function(i){
  if (i == Object.keys(downloaders).length){
    return;
  }
  var key = Object.keys(downloaders)[i];
  downloaders[key].getPage().then(download.bind(this, i+1));
};

var get = function(name){
  return downloaders[name].getPage();
};

module.exports = {
  get: get,
  start: start,
};
