var SpecialChars = require('app/terminal2/input/prompt/special_chars');

var Prompt = require('app/terminal2/input/prompt/controller');
var View = require('app/terminal2/input/view');
var Model = require('app/terminal2/input/model');


function Controller($el, prompt){
  this.input = new Model(prompt);

  var $view = $el.find('.terminal-input-prompt');
  new Prompt($view, prompt);

  $el.on('keydown', keydown.bind(this));
  $el.keypress(keypress.bind(this));
}

//private, must be bound

var keydown = function(event){
  var specialChar = SpecialChars.getSpecial(event.keyCode);

  if (specialChar){
    event.preventDefault();
    this.input.special(specialChar);
  }

};

var keypress = function(event){
  event.preventDefault();

  if (SpecialChars.getSpecial(event.keyCode)) {
    return;
  }
  var typedChar = String.fromCharCode(event.charCode);

  this.input.addChar(typedChar);

};

module.exports = Controller;
