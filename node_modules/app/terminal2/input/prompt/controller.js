var $ = require('jquery');

var View = require('app/terminal2/input/prompt/view');

var SpecialChars = require('app/terminal2/input/prompt/special_chars');

function Controller($el, prompt){
  this.prompt = prompt;

  $el.on('keydown', keydown.bind(this));
  $el.keypress(keypress.bind(this));
  var $view = $el.find('.terminal-input-prompt');

  new View($view, prompt);
}

//private, must be bound

var keydown = function(event){
  var specialChar = SpecialChars.getSpecial(event.keyCode);

  if (specialChar){
    event.preventDefault();
    this.prompt[specialChar]();
  }

};

var keypress = function(event){
  event.preventDefault();

  if (SpecialChars.getSpecial(event.keyCode)) {
    return;
  }
  var typedChar = String.fromCharCode(event.charCode);

  this.prompt.addChar(typedChar);

};

module.exports = Controller;
