var $ = require('jquery');
var terminal = require('app/terminal/model');

function Controller(){
  $(document).on('click', '*[data-input]', hijack.bind(this));
  this.hijacking = false;
}

//private, must be bound

var hijack = function(event) {
  if (this.hijacking || ! event.target.dataset.input) {
    return;
  }
  event.preventDefault();

  $('body').addClass('is-hijacking-link');
  this.hijacking = true;

  var input = event.target.dataset.input;
  terminal.type(input).then(doneHijacking.bind(this));
};

var doneHijacking = function(){
  this.hijacking = false;
  $('body').removeClass('is-hijacking-link');
};


module.exports = Controller;
