"use strict";
var $ = window.jQuery;
var terminal = require('app/terminal/model');

function Controller(){
  $(document).on('click', 'a', hijack.bind(this));
  this.hijacking = false;
}

//private, must be bound

var hijack = function(event) {
  var input;

  event.preventDefault();
  if (this.hijacking) {
    return;
  }

  $('body').addClass('is-hijacking-link');
  this.hijacking = true;

  if (! event.target.dataset.input){
    input = "link \"" + $(event.target).attr("href") + "\"";
  }
  else {
    input = event.target.dataset.input;
  }

  terminal.type(input).then(doneHijacking.bind(this));
};

var doneHijacking = function(){
  this.hijacking = false;
  $('body').removeClass('is-hijacking-link');
};

module.exports = Controller;
