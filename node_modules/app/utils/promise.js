function Promise(){
  this.successFunctions = [];
  this.failureFunctions = [];
}

Promise.prototype.then = function(fn){
  this.successFunctions.push(fn); 
  return this;
};

Promise.prototype.fail = function(fn){
  this.failureFunctions.push(fn);
  return this;
};

Promise.prototype.resolve = function(){
  runAll.call(this, this.successFunctions, arguments);
};

Promise.prototype.reject = function(args){
  runAll.call(this, this.failureFunctions, arguments);
};

//private must be bound

var runAll = function(fns, args){

  fns.forEach(function(fn){
    fn.apply(this, args);
  });

  this.successFunctions = this.failureFunctions = [];
};

module.exports = {
  create: function(){ return new Promise(); }
};
