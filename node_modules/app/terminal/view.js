var terminal = require('app/terminal/model');

var $body;
var time = 600;

function View(body){
  $body = body;

  terminal.events.on('stateChanged', resize.bind(this));
}

var resize = function(){
  setState(terminal.state).then(function(newState){
    $body.find('.terminal').scrollTop(10000);
  });
};

var setState = function(state){
  var deferred = $.Deferred();

  $body.attr('data-terminal-state', state);
  $body.find('.terminal').focus();

  setTimeout(function(){
    deferred.resolve(state);
  }, time);

  return deferred.promise();
};

module.exports = View;
