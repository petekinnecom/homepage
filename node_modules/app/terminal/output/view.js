'use strict';
var $ = require('jquery');

function View($container, outputModel){
  this.$el = $container;
  outputModel.events.on('lineAdded', this.addLine.bind(this));
  outputModel.events.on('cleared', this.clear.bind(this));
}

View.prototype.addLine = function(line){
  var $line, css, promptName;
  
  css = 'terminal-output--' + line.type;

  $line = $('<p class="terminal-output terminal-output--line"></p>');

  $line.addClass(css);

  if (line.data.promptName){
    $line.attr('data-prompt-name', line.data.promptName);
  }

  $line.html(line.text);

  if (line.data.input){
    var $link = $('<a></a>');
    $link.attr('data-input', line.data.input);
    $link.html(line.text);
    $line.html($link);
  }

  this.$el.append($line);
  this.$el.closest('.terminal').scrollTop(10000);
};

View.prototype.clear = function(){
  var $lastInput = this.$el.find('.terminal-output--input').last();
  this.$el.html($lastInput);
};

module.exports = View;
