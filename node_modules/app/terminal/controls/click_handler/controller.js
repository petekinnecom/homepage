"use strict";

var Model = require('app/terminal/controls/click_handler/model');
var View = require('app/terminal/controls/click_handler/view');

var TerminalTogglerCommand = require('app/terminal/commands/terminal_toggler');
var ActivatorCommand = require('app/terminal/commands/activator');

function Controller($el, isMobile){
  var enabled = ! isMobile;
  var model = new Model(enabled);
  var view = new View($el);

  model.events.on('enabled', view.enabled.bind(view));
  model.events.on('disabled', view.disabled.bind(view));

  $(document).on('click', function(event){
    model.handle(inTerminalView(event.target));
  });

  new TerminalTogglerCommand({
    enable: model.enable.bind(model),
    disable: model.disable.bind(model),
  });

  new ActivatorCommand();
}

var inTerminalView = function(el){
 return $.contains( $('.terminal')[0], el) ||  ( $('.terminal')[0] == el );
};

module.exports = Controller;
