"use strict";

var terminal = require('app/terminal/model');
var EventEmitter = require('events').EventEmitter;

function ClickHandler(enabled){
  this.events = new EventEmitter();
  this.enabled = enabled;
}

ClickHandler.prototype.handle = function(clickedTerminal){
  if (this.typing){
    return;
  }

  if (clickedTerminal) {

    if (this.enabled) {
      terminal.open();
    }

    else {
      setTyping.call(this, true);
      terminal.type('page navigation')
        .then(setTyping.bind(this, false));
    }
  }
  else {
    terminal.close();
  }
};

ClickHandler.prototype.enable = function(){
  this.enabled = true;
  this.events.emit('enabled');
};

ClickHandler.prototype.disable = function(){
  this.enabled = false;
  this.events.emit('disabled');
};

var setTyping = function(bool){
  this.typing = bool;
};

var toggle = function(bool){
  this.enabled = bool;
};


module.exports = ClickHandler;
