"use strict";

var ga = null;
var queue = [];

var pageView = function(){
  var event = 'pageview';
  tryToSend(event);
};

//example event: 
//  'hitType': 'event',          // Required.
//  'eventCategory': 'button',   // Required.
//  'eventAction': 'click',      // Required.
//  'eventLabel': 'nav buttons', // Optional
//  'eventValue': 4              // Optional
//
var event = function(e){
  e.hitType = 'event';

  tryToSend(e);
};

var tryToSend = function(event){
  queue.push(event);

  if(ga){
    flushQueue();
  }
};

var flushQueue = function(){
  queue.forEach(function(event){
    ga('send', event);
  });
};

//Get this working...
window.registerGoogleAnalytics = function(_ga){
  ga = _ga;
  flushQueue();
};

module.exports = {
  pageView: pageView,
  event: event,
};
